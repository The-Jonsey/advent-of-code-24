package main

import "strings"

type GuardDirection interface {
	transformGuardPos(x int, y int) []int
}

type UpwardsGuardDirection struct {
}

func (UpwardsGuardDirection) transformGuardPos(x int, y int) []int {
	return []int{x, y - 1}
}

type DownwardsGuardDirection struct {
}

func (DownwardsGuardDirection) transformGuardPos(x int, y int) []int {
	return []int{x, y + 1}
}

type LeftGuardDirection struct {
}

func (LeftGuardDirection) transformGuardPos(x int, y int) []int {
	return []int{x - 1, y}
}

type RightGuardDirection struct {
}

func (RightGuardDirection) transformGuardPos(x int, y int) []int {
	return []int{x + 1, y}
}

var UPWARDS = UpwardsGuardDirection{}
var LEFT = LeftGuardDirection{}
var RIGHT = RightGuardDirection{}
var DOWN = DownwardsGuardDirection{}

func nextGuardDirection(direction GuardDirection) GuardDirection {
	if direction == UPWARDS {
		return RIGHT
	} else if direction == RIGHT {
		return DOWN
	} else if direction == DOWN {
		return LEFT
	} else {
		return UPWARDS
	}
}

func main() {
	input := ".......#.........#..............#........................#......#....#............................#..#...............#............\n...................#.............................................#...................................#............................\n...............#.................................##.........#..........#.....##...#...#.....#....#..................#.............\n#.............................................#..#.............#..........#.##.............................................#......\n#.........................................................#.....#........................................##.......................\n...........#.......#.#...........#....#.#...#......................................#...........................#...##............#\n........................................................#..#.....................................#..#................#....#...#...\n#.#.....#.........................#...........#.......................................#.......#.....................##............\n.......#..........##.....#........#..................................................#.........................................#.#\n#.#..............#.#.............................#............#....#...............#.........................#............#..#.#.#\n..........................................................#....................................................#..................\n.......................#....#...........#.....................#....#...#.......#..............#.......................#...........\n..............................#..............#.......#....................................#.....................#...#...#.........\n........#.................#...#....##..............#...........................#............................#.................#...\n..................#........................................#......#......................................................#........\n.............#.................#...#..............................................................................#...#...........\n.....................................#..........................................................#.#.#......#.........#............\n..........#...................................................................#.........##.......#..#.............................\n...#.#....................................#..#...........#.......................................................##...............\n........................................................................................................#.........................\n.........#...........#......#..............#........#....................#...#......#.............................................\n........#....#...............#....................#..........#.....................................#......#......#........#.#.....\n........................#..........................#.......#........................#................#......#.....................\n......................................#.........................................#............................#....................\n...................................#.#...#...........#.........................................#.....................#............\n.................#....#.....................................................................#..................#.........#........\n...........#...........................................................#.............................#...............#..#.........\n..#.....................#.........................................................................................................\n....................#....#.#...........................#...........................................#..............#...............\n...#...................................................#.............................................#.........#..........#.......\n.............................###.....#..#..#......................................................................................\n##................#.#.......#..............#.....#...............#..#............#................................................\n......#...............................................#.#..#............................#............#.................#..........\n........................................#.#...................................................#.....#.............................\n#.......#.#.......................#.....#....................................#...................#................................\n...##................................................................................................#.....................#......\n............#.............#..................#.................#..................................................................\n...#..............#..............................................................................#..........#......#..............\n...#..#...#................................................#.....................#......#......................#.......#..........\n.................#..#........#...............#.#................#......##.................#.................................#.....\n#.....#.......#...........................................#..........#..............................#...#.#..#......#.....#.......\n....................................#.........#........#..................#.............................................#.........\n#...............................#........................#.................................................#.....#................\n..#..................................#.......#.....................#..............................................................\n........#...#.....................................#......#..............#..#..#..........................#.#....#.................\n.............#..........#....#................#.......#..........................................#.....#..........................\n.............................................#................................#.........................#...#.....................\n.........#........#...................................................................#.......#....#..............................\n....................................#.......................#..............#...............................#......................\n....#....................#................................#....#...........#.............#........................................\n....#...........#...................#.#..................................................#.....................#..................\n..........#....................#............#.##...#.......#....#...............#.....#...#.........................#.............\n.......#....................................................................................................#.................#...\n...............................................................................#......#.................#...#.....................\n..................#........#..........#..........................................................................#................\n..........................................................................................#.......................................\n.#..#...........#.................................##...........................#.....#...................#..#.....................\n........................#..#..........................................................#............#..................#..........#\n...........#...................................................##...........................#...............................#.....\n........#......................................................................................................#..................\n........#..#............................#..#...........#..............................#......................#.##...........#....#\n........#...#.#..............#...#.....................#....................#.#..............................#....................\n.......................................................#....................................................#..#..................\n...........................................#......................#................#........................#....................#\n.............#...............#................................................................................#...................\n..#...#............#.............#.....#........................#............#....................#...............................\n.....#...................................................................................................................#........\n....................#..#...........#....#.............................................................................#.......#...\n..............#......#.........................#...........#...#...........................................#...#..................\n..............................#.....#.........................................................#......#.#......#...................\n............................................................#...................#.#............................#..................\n.............###.#........................................#........................................................#..............\n......#................................#...............##.........................................................................\n.........#.....#.#.....................#.......................................#...............#..........#....#....#.............\n..............................................#....................................#...........................................#..\n............#.#..........#........#..#.....#.............#..........#............#......#...................##..........#.........\n............#....#...................................#.............................#.........................#....................\n.#..................................#....#.........................................................................#..............\n.........................#...#...#.................#..................#.............#.#...#...............#.......................\n.........#...............................#...........#.............................#...........................#..........#.......\n......#..........................#.............#..........#.......................................................................\n.......#...............#.........#.............#...............................#..................................................\n..#......#....................##...........................................#........................................#.............\n..........................#.....#.......................#...........................................................#.#...........\n..#....................#.............#................................................................#.#.........................\n.........#....................#.....#....#...............#.......................#........#.......................................\n..............#...................................................................#................#...#..........................\n....................#.....#.......#..#......................................#...........#..................................##....#\n.......#.......................................................................#..................................................\n......#.............##..........................#..#......................^.......................................................\n..............................#..........#...................#.................................#.....................#............\n.......................##..........................#.......#..............................#...................................#.#.\n................#....................................................................#...............................#.........#..\n..........................................#......#.....................................#................#........#................\n#......................................#.......................................................#..#...........#...................\n.......#.............#..................#..#...#............#.......#.....#.....#.#...............................................\n.............................#........#.............#.....#.......#...................................#.#..................#......\n.................#......................................................................................#........#..#.............\n........................................................................#..............#.....#..............................#.....\n....#....#..........................................#......##...#....................#...................#..........#.............\n.................##.......................##.#.........#................................................#.........................\n.#..............................................#.........................#.#.#..........#.....................................##.\n............................................................#..........#....#...................................................#.\n....#...........#.............................#.....................#.........#..................#...........................#....\n......#.#.......#..#......#........#..#...................#....#..................................................................\n............#........................................................................................................#............\n.....................................................#..........................................#................#................\n...#.......#..#..............#.............................#....................................#.................................\n.................##.........#........................#....................................#...............#.#.#...................\n................#......#......................#..#..........................................#.....................................\n......#..................................................##.#.#........#...........................#.......................#......\n........................#............#......#.........#.............#.............................................#.....#.##......\n......................#........................................#.......#.........#.................#..#...........#...............\n..#.......#.........##..#.#................................................................................#.........#............\n........................................................................................#............#...........#................\n................#...#....................#..##..#...............#.............................................................#...\n...#........#..........................#.....#..........................#....................................#.........#.......##.\n.................#...........................#.........#......#............................#.....................#................\n...................#..........#....#.......#...................#.............................#..........#.........................\n.......#..............#.................................#.........#....................................#.................#....##.#\n..................................#.......................#....#..#.........................#....................#................\n.....#.........#............#...#.........#........#...................#...#......................#.....#............#............\n#.#....#...#........#................................##..........................#.............................##...#....#........\n.............##..........##...#......#.......#.#................#.#.......................#.............#.........................\n.............#....................................#....................................#..........................................\n..................................#..............................#.......................................#................#.......\n...................#...............#..............................................................................................\n....#........#.................................#........#.....................................#.......#................#........#.\n.................#......#.......................................................##.....#..................#.......................\n...............#.......................#.#........#...........................................#........#..........................\n"
	var grid [][]string
	for _, row := range strings.Split(input, "\n") {
		grid = append(grid, strings.Split(row, ""))
	}
	var guardPos = []int{0, 0}
	for y := range grid {
		for x, i := range grid[y] {
			if i == "^" {
				guardPos = []int{x, y}
			}
		}
	}
	guardInMap := true
	distinctSquares := 0
	var guardDirection GuardDirection

	guardDirection = UPWARDS

	for guardInMap {
		println("Checking pos ", guardPos[0], ":", guardPos[1])
		if grid[guardPos[1]][guardPos[0]] != "X" {
			grid[guardPos[1]][guardPos[0]] = "X"
			distinctSquares++
		}

		newPos := guardDirection.transformGuardPos(guardPos[0], guardPos[1])

		if newPos[0] >= len(grid[newPos[1]]) || newPos[0] < 0 || newPos[1] >= len(grid) || newPos[1] < 0 {
			guardInMap = false
			break
		}

		if grid[newPos[1]][newPos[0]] == "#" {
			guardDirection = nextGuardDirection(guardDirection)
		} else {
			guardPos = newPos
		}

	}
	println(distinctSquares)
}
